package com.victor.presenter;import android.util.Log;import com.victor.data.PhoneCodeReq;import com.victor.okhttp.library.annotation.HttpParms;import com.victor.okhttp.library.data.Request;import com.victor.okhttp.library.inject.HttpInject;import com.victor.okhttp.library.module.HttpRequest;import com.victor.okhttp.library.presenter.impl.BasePresenterImpl;import com.victor.view.PhoneCodeView;import java.io.IOException;import java.lang.reflect.ParameterizedType;import java.lang.reflect.Type;import java.net.ConnectException;import java.net.SocketTimeoutException;import java.net.UnknownHostException;/* * ----------------------------------------------------------------- * Copyright (C) 2018-2028, by Victor, All rights reserved. * ----------------------------------------------------------------- * File: PhoneCodePresenterImpl.java * Author: Victor * Date: 2018/9/6 18:25 * Description: * ----------------------------------------------------------------- */public class PhoneCodePresenterImpl<H,T> extends BasePresenterImpl<H,T> {	/*Presenter作为中间层，持有View和Model的引用*/	private PhoneCodeView phoneCodeView;	public PhoneCodePresenterImpl(PhoneCodeView phoneCodeView) {		this.phoneCodeView = phoneCodeView;		/*Type[] types = phoneCodeView.getClass().getGenericInterfaces();		ParameterizedType parameterizedType = (ParameterizedType) types[2];		Type[] params = parameterizedType.getActualTypeArguments();		Class<T> reponseClass = (Class) params[0];		Log.e("PhoneCodePresenterImpl","reponseClass.getSimpleName() = " + reponseClass.getSimpleName());		Log.e("PhoneCodePresenterImpl","reponseClass.getCanonicalName() = " + reponseClass.getCanonicalName());		Log.e("PhoneCodePresenterImpl","reponseClass.getName() = " + reponseClass.getName());		Log.e("PhoneCodePresenterImpl","reponseClass.getTypeName() = " + reponseClass.getTypeName());*/	}	@Override	public void onSuccess(T data) {		if (phoneCodeView == null) return;		if (data == null) {			phoneCodeView.OnPhoneCode(null,"no data response");		} else {			phoneCodeView.OnPhoneCode(data,"");		}	}	@Override	public void onError(IOException error) {		if (phoneCodeView == null) return;		String msg = error.getMessage();		if (error instanceof SocketTimeoutException) {			//判断超时异常			msg = "onFailure()......连接超时";		} else if (error instanceof ConnectException) {			////判断连接异常，			msg = "onFailure()......连接服务器异常";		} else if (error instanceof UnknownHostException) {			////判断连接异常，			msg = "onFailure()......未知主机异常";		}		phoneCodeView.OnPhoneCode(null,msg);	}	@Override	public void detachView() {		phoneCodeView = null;	}	@HttpParms(method = Request.POST,bodyContentType = HttpRequest.mDefaultBodyContentType,			responseCls = PhoneCodeReq.class)	@Override	public void sendRequest(String url, H header, T parm) {		HttpInject.inject(this);		super.sendRequest(url,header,parm);	}}